import{Scroll}from"./scroll.js";import{Cursor}from"./cursor.js";let type,scrollValue=document.getElementById("scroll-value"),scrollName=document.getElementById("scroll-name"),scrollLeft=document.getElementById("scroll-left"),scrollRight=document.getElementById("scroll-right"),gallery=document.getElementById("gallery"),icon1=document.getElementById("icon1"),icon2=document.getElementById("icon2"),matcher=window.matchMedia("(prefers-color-scheme: dark)"),types=[{name:"images",amount:15,file:".jpeg",tag:"img"},{name:"videos",amount:10,file:".mp4",tag:"video"}],updateVH=()=>document.documentElement.style.setProperty("--vh",.01*window.innerHeight+"px");function iconUpdate(){matcher.matches?(document.head.append(icon1),icon2.remove()):(document.head.append(icon2),icon1.remove())}function init(){evalHash(),loadMedia(),document.getElementById("info").children[1].innerHTML=types[type].name,Scroll.pages=gallery.children[0].children.length,Scroll.touchMode="x",Scroll.time=300,Scroll.setOnScroll(onScroll),Cursor.init(),Scroll.init(),scrollLeft.addEventListener("click",()=>Scroll.doScroll(-1)),scrollRight.addEventListener("click",()=>Scroll.doScroll(1)),requestAnimationFrame(update)}function update(){scrollValue.innerText=Scroll.currentScroll.toFixed(1),scrollName.innerText=gallery.children[0].children[Scroll.targetScroll].children[0].src.replace(/^.*[\\\/]/,""),gallery.scrollLeft=gallery.scrollWidth*Scroll.currentScroll/Scroll.pages,1===type&&Scroll.currentScroll===Scroll.targetScroll&&updateAutoplay(),requestAnimationFrame(update)}function onScroll(){gallery.children[0].children[Scroll.prevScroll].className="prev",gallery.children[0].children[Scroll.nextScroll].className="next",gallery.children[0].children[Scroll.targetScroll].className="curr",0===Scroll.targetScroll?(scrollLeft.style.opacity="0",scrollLeft.style.pointerEvents="none"):Scroll.targetScroll===Scroll.pages-1?(scrollRight.style.opacity="0",scrollRight.style.pointerEvents="none"):(setTimeout(()=>{scrollLeft.style.opacity="1",scrollRight.style.opacity="1"},Scroll.time/2),scrollLeft.style.pointerEvents="all",scrollRight.style.pointerEvents="all")}function evalHash(){switch(window.location.hash){case"#images":type=0;break;case"#videos":type=1;break;default:window.location="#images",window.location.reload()}}function loadMedia(){let e="./media/gallery/"+types[type].name+"/";for(let l=0;l<types[type].amount;l++){let t=document.createElement("div"),o=document.createElement(types[type].tag);o.src=e+l+types[type].file,t.appendChild(o),gallery.children[0].appendChild(t),1===type&&(o.muted=!0,o.defaultMuted=!0,o.loop=!0,o.playsInline=!0,o.controls=!1)}}function updateAutoplay(){let e=document.getElementById("gallery").children[0].children;for(let l=0;l<e.length;l++){let t=e[l].children[0];l===Scroll.targetScroll?t.play():(t.pause(),t.currentTime=0)}}window.addEventListener("resize",updateVH),setInterval(updateVH,100),updateVH(),init(),"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||VanillaTilt.init(gallery,{max:1,scale:1.05,speed:1e3}),matcher.onchange=iconUpdate,iconUpdate();